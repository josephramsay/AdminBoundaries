/**
build.gradle

Copyright 2014 Crown copyright (c)
Land Information New Zealand and the New Zealand Government.
All rights reserved

This program is released under the terms of the new BSD license. See the
LICENSE file for more information.
 */
 
 buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
    }

    dependencies {
        classpath "org.postgresql:postgresql:9.4-1206-jdbc42"
        classpath 'com.bmuschko:gradle-cargo-plugin:2+'
    }
}

ext {
    postgresqlApiVersion = '9.4-1206-jdbc42'
    postGISApiVersion = '2.2.0'
    servletApiVersion = '3.+'
    junitVersion = '4.12'
}



apply plugin: 'java'
apply plugin: 'war'
apply plugin: 'com.bmuschko.cargo'


archivesBaseName = 'ab'
version = '0.1'
sourceCompatibility = '1.8'

def webContext = 'ab'
def warName = 'build/libs/ab.war'

war {
    manifest {
        attributes 'Implementation-Title': 'LINZ Admin Boundaries Downloader',
            'Implementation-Version': version

    }
    archiveName = warName
}


task deploy {
    dependsOn war
	cargo {
	    containerId = 'tomcat7x'
	    port = 8080
	
	    deployable {
	        file = file(warName)
	        context = webContext
	    }
	
	    remote {
	       protocol = "${remoteProtocol}"
	       hostname = "${remoteHost}"
	       username = "${remoteUser}"
	       password = "${remotePass}"
	    }
	
	}
}

repositories {
    mavenCentral()
}

dependencies {
    //classpath "org.postgresql:postgresql:$postgresqlApiVersion"
    providedCompile "javax.servlet:servlet-api:$servletApiVersion"
    providedRuntime "org.postgresql:postgresql:$postgresqlApiVersion"
    providedRuntime "net.postgis:postgis-jdbc:$postGISApiVersion"
    testCompile "junit:junit:$junitVersion" 
}

